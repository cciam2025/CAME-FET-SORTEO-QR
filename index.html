function doPost(e) {
  try {
    const SPREADSHEET_ID = "1AlVBY1bOSfbIc4ytlyjgQXu0PgqcgmnTWhafRedIsek"; // TU ID DE HOJA
    const SHEET_NAME = "Hoja 1"; // NOMBRE EXACTO DE TU PESTAÑA

    const spreadsheet = SpreadsheetApp.openById(SPREADSHEET_ID);
    if (!spreadsheet) throw new Error("No se pudo abrir la hoja de cálculo. Verifica el ID.");
    const sheet = spreadsheet.getSheetByName(SHEET_NAME);
    if (!sheet) throw new Error("No se encontró la pestaña '" + SHEET_NAME + "'. Verifica el nombre.");

    // Datos del participante (vienen de los campos visibles del formulario)
    const nombreParticipante = e.parameter.nombre;
    const apellidoParticipante = e.parameter.apellido;
    const dniParticipante = e.parameter.dni;
    const telefonoCliente = e.parameter.telefono;     // Name: "telefono"
    const direccionParticipante = e.parameter.direccion;
    const ciudadParticipante = e.parameter.ciudad;    // Name: "ciudad"

    // Datos del negocio (vienen de los campos hidden, poblados desde los params URL)
    const nombreDelNegocio = e.parameter.negocio;          // Name: "negocio"
    const razonSocialNegocio = e.parameter.razonsocial;    // Name: "razonsocial"
    const cuitNegocio = e.parameter.cuit;                  // Name: "cuit"
    const ciudadDelNegocio = e.parameter.ciudad_negocio;   // Name: "ciudad_negocio"
    const telefonoDelNegocio = e.parameter.telefono_negocio; // Name: "telefono_negocio"

    // Log para depuración (puedes verlo en las Ejecuciones de Apps Script)
    Logger.log("Datos recibidos: " + JSON.stringify(e.parameter));
    Logger.log("Razón Social Negocio: " + razonSocialNegocio); // Específicamente para ver si llega

    // ORDEN DE COLUMNAS:
    // A: Timestamp, B: Nombre Part., C: Apellido Part., D: DNI Part., E: Teléfono Part.,
    // F: Dirección Part., G: Ciudad Part., H: Nombre Negocio, I: Razón Social Neg.,
    // J: CUIT Neg., K: Ciudad Neg., L: Teléfono Neg.
    sheet.appendRow([
      new Date(),
      nombreParticipante,
      apellidoParticipante,
      dniParticipante,
      telefonoCliente,
      direccionParticipante,
      ciudadParticipante,
      nombreDelNegocio,
      razonSocialNegocio,   // <-- Dato para Columna I
      cuitNegocio,          // <-- Dato para Columna J
      ciudadDelNegocio,     // <-- Dato para Columna K
      telefonoDelNegocio    // <-- Dato para Columna L
    ]);

    return ContentService.createTextOutput(JSON.stringify({
        "result": "success",
        "message": "¡Gracias! Tus datos han sido guardados correctamente."
      }))
      .setMimeType(ContentService.MimeType.JSON);

  } catch (error) {
    Logger.log("Error en doPost: " + error.toString() + " Stack: " + error.stack);
    return ContentService.createTextOutput(JSON.stringify({
        "result": "error",
        "message": "Error al procesar la solicitud: " + error.toString()
      }))
      .setMimeType(ContentService.MimeType.JSON);
  }
}
